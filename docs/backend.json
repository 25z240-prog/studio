
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a hostel resident.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "name": {
          "type": "string",
          "description": "The name of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "hasPassword": {
          "type": "boolean",
          "description": "Indicates if the user has created a password."
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "MenuItem": {
      "title": "Menu Item",
      "type": "object",
      "description": "Represents a menu item in the hostel mess.",
      "properties": {
        "title": {
          "type": "string",
          "description": "The name of the menu item."
        },
        "category": {
          "type": "string",
          "enum": [
            "breakfast",
            "lunch",
            "snack",
            "dinner"
          ],
          "description": "The meal category (e.g., breakfast, lunch)."
        },
        "day": {
          "type": "string",
          "enum": [
            "monday",
            "tuesday",
            "wednesday",
            "thursday",
            "friday",
            "saturday",
            "sunday"
          ],
          "description": "The day of the week the item is served."
        },
        "ingredients": {
          "type": "string",
          "description": "A comma-separated list of main ingredients."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for the menu item's image.",
          "format": "uri"
        },
        "imageHint": {
          "type": "string",
          "description": "A hint for AI image generation."
        },
        "dietaryInfo": {
          "type": "string",
          "enum": [
            "veg",
            "non-veg"
          ],
          "description": "Dietary information (e.g., veg, non-veg)."
        },
        "votes": {
          "type": "number",
          "description": "The number of votes the menu item has received."
        }
      },
      "required": [
        "title",
        "category",
        "day",
        "imageUrl",
        "imageHint",
        "dietaryInfo",
        "votes"
      ]
    },
    "UserVote": {
      "title": "User Vote",
      "type": "object",
      "description": "Tracks a single vote from a user for a menu item to prevent duplicate voting.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID of the user who voted."
        },
        "menuItemId": {
          "type": "string",
          "description": "The ID of the menu item that was voted for."
        },
        "votedAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the vote was cast."
        }
      },
      "required": [
        "userId",
        "menuItemId",
        "votedAt"
      ]
    },
    "MenuState": {
      "title": "Menu State",
      "type": "object",
      "description": "Stores the state of the weekly menu, e.g., whether it is finalized.",
      "properties": {
        "isFinalized": {
          "type": "boolean",
          "description": "Indicates if the menu for the week has been finalized."
        }
      },
      "required": [
        "isFinalized"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles.  User IDs are used as document IDs.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/menuItems/{menuItemId}",
        "definition": {
          "entityName": "MenuItem",
          "schema": {
            "$ref": "#/backend/entities/MenuItem"
          },
          "description": "Stores all available menu items for voting.",
          "params": [
            {
              "name": "menuItemId",
              "description": "The unique identifier for the menu item."
            }
          ]
        }
      },
      {
        "path": "/userVotes/{voteId}",
        "definition": {
          "entityName": "UserVote",
          "schema": {
            "$ref": "#/backend/entities/UserVote"
          },
          "description": "Tracks individual user votes to prevent duplicates. The document ID is a composite of userId and menuItemId.",
          "params": [
            {
              "name": "voteId",
              "description": "Composite key: `${userId}_${menuItemId}`"
            }
          ]
        }
      },
      {
        "path": "/menuState/{stateId}",
        "definition": {
          "entityName": "MenuState",
          "schema": {
            "$ref": "#/backend/entities/MenuState"
          },
          "description": "Stores the state of the menu. 'weekly' is used as the document ID.",
          "params": [
            {
              "name": "stateId",
              "description": "The identifier for the menu state, e.g., 'weekly'."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support a hostel menu voting application. It includes a 'users' collection for profiles, a 'menuItems' collection for votable items, and a 'userVotes' collection to enforce the one-vote-per-user-per-item rule. The 'menuState' collection manages the lifecycle of the menu, such as finalization. This structure separates user data, application data, voting records, and state management for clear organization and security."
  }
}

    